
CREATE OR REPLACE FUNCTION get_login_name
 (loginid BIGINT
 )
  RETURNS character varying AS
$BODY$
DECLARE
  l_name character varying(30);
  lrl CURSOR(n_id BIGINT)
    IS
    SELECT r.acct_login
      FROM accounts r
     WHERE r.acct_id = n_id
     ;

BEGIN
  OPEN lrl(loginid);
  FETCH lrl INTO l_name;
  CLOSE lrl;
  RETURN r_name;
END;
$BODY$
  LANGUAGE 'plpgsql' VOLATILE
  SECURITY DEFINER;

COMMENT ON FUNCTION get_login_name
 (BIGINT
 )
 IS 'Логин по ИД аккаунта';

REVOKE ALL ON FUNCTION get_login_name
 (BIGINT
 ) FROM public;

GRANT EXECUTE ON FUNCTION get_login_name
 (BIGINT
 ) TO track_server_all;
